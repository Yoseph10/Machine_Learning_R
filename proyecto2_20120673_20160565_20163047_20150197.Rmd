---
title: "Proyecto 2"
#author: ""
#date: "3/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Integrantes:**

Luciana Figueroa Valdivia (20120673),
Chiara Zamora Mendoza (20160565),
Yoseph Ayala Valencia (20163047),
Claudia Villena Tagle (20150197)


```{r}
#loading libraries
library(ISLR2)
library(glmnet)
library(MASS)
library(boot)
```

**1)   **


**2)   **

**Enfoque del voto mayoritario**

Consideraremos como punto de corte al 0.5. Es decir, si es que hay más cantidad de valores que sean mayor o igual a 0.5, ello significa que el voto mayoritario indica que la predicción nos da rojo. Si es que es menor a 0.5, la predicción nos da verde.
Encontramos que 6 valores son mayores o iguales a nuestro punto de corte (0.5) y que 4 son menores. De esta forma, 6 > 4 lo que implica que, bajo este enfoque, la predicción nos debe dar rojo.

**Enfoque de probabilidad media**

Para este enfoque, solo debemos promediar los valores. Realizando ello, obtenemos un valor de 0.45. Al ser este menor que nuestro punto de corte (0.5), nos indicaría que la predicción es verde bajo este enfoque.


```{r}
#creamos el vector con el conjunto de valores
r <-  c(0.1, 0.15, 0.2, 0.2, 0.55, 0.6, 0.6, 0.65, 0.7, 0.75)

#Enfoque del voto mayoritario
R <- sum(r >= 0.5)
R

G <- sum(r < 0.5)
G

R > G #TRUE

#Enfoque de probabilidad media
mean(r) #0.45

```


**3)   **


**4)   **


**5)   **

```{r}

library(MASS)
library(randomForest)

set.seed(1)

#empezamos a crear train y tests simples

n <- nrow(Boston)
train.set <- sample(1:n,n/2)

Boston.train <- Boston[train.set, -14]
Boston.test <- Boston[-train.set, -14]

Y.train <- Boston[train.set, 14]
Y.test <- Boston[-train.set, 14]

#Creamos los distintos random forest con distintos mtry

rf.a <- randomForest(Boston.train , Y.train, Boston.test, Y.test, mtry = ncol(Boston.train), ntree = 5000)
rf.b <- randomForest(Boston.train , Y.train, Boston.test, Y.test, mtry = ncol(Boston.train) / 2, ntree = 5000)
rf.c <- randomForest(Boston.train , Y.train, Boston.test, Y.test, mtry = sqrt(ncol(Boston.train)), ntree = 5000)

#Gráfico que muestra los errores de prueba

library(ggplot2)
ggplot() + 
  geom_line(aes(x = c(1:5000), y = rf.a$test$mse, color = "M = P")) +
  geom_line(aes(x = c(1:5000), y = rf.b$test$mse, color = "M = P/2")) +
  geom_line(aes(x = c(1:5000), y = rf.c$test$mse, color = "M = Sqrt(P)")) +
  theme_classic() + 
  xlab("Number of Trees") + ylab("Test Classification Error") + scale_colour_discrete(name="Form")

rf.a$test$mse[5000]

rf.b$test$mse[5000]

rf.c$test$mse[5000]


```

